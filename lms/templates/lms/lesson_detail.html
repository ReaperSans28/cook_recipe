{% extends 'landing/base.html' %}
{% load static %}
{% block content %}

<div class="container-fluid py-3">
    <div class="row justify-content-center">
        <div class="col-lg-10 col-xl-8">
            <!-- Заголовок урока - уменьшенные паддинги и маргины -->
            <div class="card border-0 shadow-sm mb-3">
                <div class="card-body p-3 p-md-4">
                    <div class="d-flex align-items-start justify-content-between">
                        <div class="flex-grow-1">
                            <h1 class="h2 fw-bold text-dark mb-2">{{ lesson.title }}</h1>
                            <nav aria-label="breadcrumb" class="mb-3">
                                <ol class="breadcrumb mb-0">
                                    <li class="breadcrumb-item"><a href="{% url 'course-list' %}"
                                                                   class="text-decoration-none text-primary small">
                                        <i class="bi bi-house-door me-1"></i>Курсы
                                    </a></li>
                                    <li class="breadcrumb-item"><a href="{% url 'course-detail' lesson.course.id %}"
                                                                   class="text-decoration-none text-primary small">
                                        {{ lesson.course.title|truncatechars:30 }}
                                    </a></li>
                                    <li class="breadcrumb-item active text-dark small" aria-current="page">
                                        {{ lesson.title|truncatechars:40 }}
                                    </li>
                                </ol>
                            </nav>
                            <!-- Мета-информация - уменьшенные отступы -->
                            <div class="d-flex flex-wrap gap-2 align-items-center">
                                <span class="badge bg-primary bg-opacity-10 text-primary py-1 px-2 small">
                                    <i class="bi bi-clock me-1"></i>{{ lesson.duration_minutes }} мин.
                                </span>
                                <span class="badge bg-secondary bg-opacity-10 text-secondary py-1 px-2 small">
                                    <i class="bi bi-calendar3 me-1"></i>{{ lesson.created_at|date:"d.m.Y" }}
                                </span>
                                {% if lesson.video_url %}
                                <span class="badge bg-success bg-opacity-10 text-success py-1 px-2 small">
                                    <i class="bi bi-play-circle me-1"></i>Есть видео
                                </span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Контент урока - уменьшенные паддинги -->
            <div class="card border-0 shadow-sm mb-3">
                <div class="card-body p-3 p-md-4">
                    <article class="lesson-content mb-0">
                        {{ lesson.content|safe }}
                    </article>
                </div>
            </div>

            <!-- Навигация - уменьшенные отступы -->
            <div class="card border-0 shadow-sm mb-3">
                <div class="card-body p-3">
                    <div class="row g-2">
                        <div class="col-md-6">
                            {% if previous_lesson %}
                            <a href="{% url 'lesson-detail' previous_lesson.id %}"
                               class="btn btn-outline-primary w-100 text-start py-2">
                                <div class="d-flex align-items-center">
                                    <div class="me-2">
                                        <i class="bi bi-chevron-left"></i>
                                    </div>
                                    <div>
                                        <small class="text-muted d-block">Предыдущий</small>
                                        <span class="fw-semibold small">{{ previous_lesson.title|truncatechars:30 }}</span>
                                    </div>
                                </div>
                            </a>
                            {% else %}
                            <button class="btn btn-outline-secondary w-100 text-start py-2" disabled>
                                <div class="d-flex align-items-center">
                                    <div class="me-2">
                                        <i class="bi bi-chevron-left"></i>
                                    </div>
                                    <div>
                                        <small class="text-muted d-block">Предыдущий</small>
                                        <span class="fw-semibold small">Первый урок</span>
                                    </div>
                                </div>
                            </button>
                            {% endif %}
                        </div>
                        <div class="col-md-6">
                            {% if next_lesson %}
                            <a href="{% url 'lesson-detail' next_lesson.id %}"
                               class="btn btn-outline-primary w-100 text-end py-2">
                                <div class="d-flex align-items-center justify-content-end">
                                    <div class="text-end me-0">
                                        <small class="text-muted d-block">Следующий</small>
                                        <span class="fw-semibold small">{{ next_lesson.title|truncatechars:30 }}</span>
                                    </div>
                                    <div class="ms-2">
                                        <i class="bi bi-chevron-right"></i>
                                    </div>
                                </div>
                            </a>
                            {% else %}
                            <button class="btn btn-outline-secondary w-100 text-end py-2" disabled>
                                <div class="d-flex align-items-center justify-content-end">
                                    <div class="text-end me-0">
                                        <small class="text-muted d-block">Следующий</small>
                                        <span class="fw-semibold small">Последний урок</span>
                                    </div>
                                    <div class="ms-2">
                                        <i class="bi bi-chevron-right"></i>
                                    </div>
                                </div>
                            </button>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Быстрые действия - уменьшенные отступы -->
            <div class="mt-4 text-center">
                <div class="d-flex flex-wrap gap-2 justify-content-center">
                    <a href="{% url 'course-detail' lesson.course.id %}"
                       class="btn btn-sm px-3 py-2 shadow-sm hover-lift"
                       style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
                        <i class="bi bi-arrow-left me-2"></i>К курсу
                    </a>
                    <button type="button"
                            class="btn btn-sm px-3 py-2 shadow-sm hover-lift bg-white border"
                            onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
                        <i class="bi bi-arrow-up me-2 text-primary"></i>
                        <span class="text-dark">Наверх</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .lesson-content {
        font-size: 1rem;
        line-height: 1.7;
    }

    .lesson-content h1 {
        font-size: 1.5rem;
        margin-top: 1.5rem;
        margin-bottom: 1rem;
    }

    .lesson-content h2 {
        font-size: 1.35rem;
        margin-top: 1.5rem;
        margin-bottom: 0.8rem;
    }

    .lesson-content h3 {
        font-size: 1.2rem;
        margin-top: 1.25rem;
        margin-bottom: 0.7rem;
    }

    .lesson-content h4 {
        font-size: 1.1rem;
        margin-top: 1.1rem;
        margin-bottom: 0.6rem;
    }

    .lesson-content p {
        margin-bottom: 1rem;
    }

    .lesson-content ul,
    .lesson-content ol {
        margin-bottom: 1rem;
        padding-left: 1.5rem;
    }

    .lesson-content li {
        margin-bottom: 0.4rem;
    }

    .lesson-content pre {
        padding: 1rem;
        margin: 1rem 0;
    }

    .lesson-content img {
        margin: 1rem 0;
    }
</style>

{% endblock %}